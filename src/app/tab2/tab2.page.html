<ion-header [translucent]="true" class="ion-no-border">
  <ion-toolbar color="cuscuz">
    <ion-title class="ion-text-left">
      <ion-text class="custom-title">{{titulo}}</ion-text>
    </ion-title>

    <div slot="end" class="cadastrar-container">
      <ion-spinner *ngIf="isLoading" name="crescent" class="spinner"></ion-spinner>
      <span
        *ngIf="!isLoading"
        (click)="cadastro()"
        class="cadastrar-text">
        Cadastrar
      </span>
    </div>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="false" color="cuscuz" class>

  <div class="center">

    <form [formGroup]="formCadastro" (ngSubmit)="cadastro()" novalidate>

      <!-- Nome -->
      <ion-item lines="full">
        <ion-label position="floating">
          <ion-icon name="person" slot="start"></ion-icon>
          Nome
        </ion-label>
        <ion-input clear-input="true" required type="text" formControlName="nome"></ion-input>
      </ion-item>

      <ion-item *ngIf="errorControl['nome'].invalid && isSubmitted" lines="none">
        <ion-text color="danger">
          <small *ngIf="errorControl['nome'].errors?.['required']">Nome é obrigatório</small>
          <small *ngIf="errorControl['nome'].errors?.['minlength']">Nome deve ter pelo menos 2 caracteres</small>
        </ion-text>
      </ion-item>

      <!-- Telefone -->
      <ion-item lines="full">
        <ion-label position="floating">
          <ion-icon name="call" slot="start"></ion-icon>
          Telefone
        </ion-label>
        <ion-input clear-input="true" required type="tel" formControlName="telefone"></ion-input>
      </ion-item>

      <ion-item *ngIf="errorControl['telefone'].invalid && isSubmitted" lines="none">
        <ion-text color="danger">
          <small *ngIf="errorControl['telefone'].errors?.['required']">Telefone é obrigatório</small>
          <small *ngIf="errorControl['telefone'].errors?.['pattern']">Digite exatamente 11 números (com DDD)</small>
        </ion-text>
      </ion-item>

      <!-- E-mail -->
      <ion-item lines="full">
        <ion-label position="floating">
          <ion-icon name="mail" slot="start"></ion-icon>
          E-mail
        </ion-label>
        <ion-input clear-input="true" required type="email" formControlName="email"></ion-input>
      </ion-item>

      <ion-item *ngIf="errorControl['email'].invalid && isSubmitted" lines="none">
        <ion-text color="danger">
          <small *ngIf="errorControl['email'].errors?.['required']">Email é obrigatório</small>
          <small *ngIf="errorControl['email'].errors?.['pattern']">Digite um email válido</small>
        </ion-text>
      </ion-item>

      <ion-item lines="none" class="custom-dropdown-container">
        <ion-label position="stacked">Dia de cadastro:</ion-label>

        <div class="custom-dropdown" [class.open]="isDropdownOpen">
          <div class="dropdown-selected" (click)="toggleDropdown()">
            <span class="selected-text">
              {{ diaSelecionado ? (diaSelecionado === 'dia1' ? 'Dia 1' : 'Dia 2') : 'Selecione' }}
            </span>
            <ion-icon [name]="isDropdownOpen ? 'chevron-up' : 'chevron-down'" class="dropdown-icon"></ion-icon>
          </div>

          <div class="dropdown-options" *ngIf="isDropdownOpen">
            <div class="dropdown-option" (click)="selectOption('dia1')">
              Dia 1
            </div>
            <div class="dropdown-option" (click)="selectOption('dia2')">
              Dia 2
            </div>
          </div>
        </div>
      </ion-item>

      <ion-item *ngIf="isSubmitted && !diaSelecionado" lines="none">
        <ion-text color="danger">
          <small>Selecione um dia</small>
        </ion-text>
      </ion-item>

    </form>

  </div>

  <!-- Toast -->
  <ion-toast
    [isOpen]="showToast"
    [message]="toastMessage"
    [color]="toastColor"
    [duration]="2000"
    (didDismiss)="showToast = false">
  </ion-toast>

</ion-content>
